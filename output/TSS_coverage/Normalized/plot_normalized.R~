bottom<-read.csv("Merged_Male_Controls_Plasma_Bottom1000_tss.txt",header=TRUE,sep="\t")
top<-read.csv("Merged_Male_Controls_Top1000_tss.txt",header=TRUE,sep="\t")
png(filename = paste("Merged_Male_Controls_Top_vs_Bottom.png",sep=""), width = 1180, height = 1180, units = "px", pointsize = 20, bg = "white", res = NA)
plot(bottom$Position,bottom$Mean.Cov,type="l",xlab="Position relative to TSS",ylab="Read depth",col="green",ylim=c(0,1.2))
polygon(c(bottom$Position,rev(bottom$Position)),c(bottom$LowerBound,rev(bottom$UpperBound)),col=rgb(0.2,0.8,0.3,0.2), border = FALSE)
lines(bottom$Position,bottom$Mean.Cov,col="green")
polygon(c(top$Position,rev(top$Position)),c(top$LowerBound,rev(top$UpperBound)),col=rgb(1,0,0,0.2), border = FALSE)
lines(top$Position,top$Mean.Cov,col="red")
dev.off()

bottom<-read.csv("MergedControls_Plasma_Bottom1000_tss.txt",header=TRUE,sep="\t")
top<-read.csv("MergedControls_Plasma_Top1000_tss.txt",header=TRUE,sep="\t")
png(filename = paste("Merged_Controls_Top_vs_Bottom.png",sep=""), width = 1180, height = 1180, units = "px", pointsize = 20, bg = "white", res = NA)
plot(bottom$Position,bottom$Mean.Cov,type="l",xlab="Position relative to TSS",ylab="Read depth",col="green",ylim=c(0,1.2))
polygon(c(bottom$Position,rev(bottom$Position)),c(bottom$LowerBound,rev(bottom$UpperBound)),col=rgb(0.2,0.8,0.3,0.2), border = FALSE)
lines(bottom$Position,bottom$Mean.Cov,col="green")
polygon(c(top$Position,rev(top$Position)),c(top$LowerBound,rev(top$UpperBound)),col=rgb(1,0,0,0.2), border = FALSE)
lines(top$Position,top$Mean.Cov,col="red")
dev.off()

png(filename = paste("MergedControls_Top_vs_Bottom_figure.png",sep=""), width = 600, height = 600, units = "px", pointsize = 10, bg = "white", res = 150)
plot(bottom$Position,bottom$Mean.Cov,type="l",xlab="Position relative to TSS",ylab="Read depth",col="green",ylim=c(0,1))
polygon(c(bottom$Position,rev(bottom$Position)),c(bottom$LowerBound,rev(bottom$UpperBound)),col=rgb(0.2,0.8,0.3,0.2), border = FALSE)
lines(bottom$Position,bottom$Mean.Cov,col="green")
polygon(c(top$Position,rev(top$Position)),c(top$LowerBound,rev(top$UpperBound)),col=rgb(1,0,0,0.2), border = FALSE)
lines(top$Position,top$Mean.Cov,col="red")
dev.off()

bottom<-read.csv("MergedControls_Plasma_Bottom1000_tss.txt",header=TRUE,sep="\t")
top<-read.csv("MergedControls_Plasma_Top1000_tss.txt",header=TRUE,sep="\t")
top100<-read.csv("MergedControls_Plasma_Top100_tss.txt",header=TRUE,sep="\t")
png(filename = paste("Merged_Controls_Top_vs_Bottom_Top100.png",sep=""), width = 1180, height = 1180, units = "px", pointsize = 20, bg = "white", res = NA)
plot(bottom$Position,bottom$Mean.Cov,type="l",xlab="Position relative to TSS",ylab="Read depth",col="green",ylim=c(0,1.2))
polygon(c(bottom$Position,rev(bottom$Position)),c(bottom$LowerBound,rev(bottom$UpperBound)),col=rgb(0.2,0.8,0.3,0.2), border = FALSE)
lines(bottom$Position,bottom$Mean.Cov,col="green")
polygon(c(top$Position,rev(top$Position)),c(top$LowerBound,rev(top$UpperBound)),col=rgb(1,0,0,0.2), border = FALSE)
lines(top$Position,top$Mean.Cov,col="red")
polygon(c(top100$Position,rev(top100$Position)),c(top100$LowerBound,rev(top100$UpperBound)),col=rgb(0,0,1,0.2), border = FALSE)
lines(top100$Position,top100$Mean.Cov,col="blue")
dev.off()

bottom<-read.csv("MergedControls_Plasma_Bottom1000_tss.txt",header=TRUE,sep="\t")
top<-read.csv("MergedControls_Plasma_Top1000_tss.txt",header=TRUE,sep="\t")
top100<-read.csv("MergedControls_Plasma_Top100_tss.txt",header=TRUE,sep="\t")
png(filename = paste("Merged_Controls_Top_vs_Bottom_Top100_indicator.png",sep=""), width = 1180, height = 1180, units = "px", pointsize = 20, bg = "white", res = NA)
plot(bottom$Position,bottom$Mean.Cov,type="l",xlab="Position relative to TSS",ylab="Read depth",col="green",ylim=c(0,1.2))
polygon(c(bottom$Position,rev(bottom$Position)),c(bottom$LowerBound,rev(bottom$UpperBound)),col=rgb(0.2,0.8,0.3,0.2), border = FALSE)
lines(bottom$Position,bottom$Mean.Cov,col="green")
polygon(c(top$Position,rev(top$Position)),c(top$LowerBound,rev(top$UpperBound)),col=rgb(1,0,0,0.2), border = FALSE)
lines(top$Position,top$Mean.Cov,col="red")
polygon(c(top100$Position,rev(top100$Position)),c(top100$LowerBound,rev(top100$UpperBound)),col=rgb(0,0,1,0.2), border = FALSE)
lines(top100$Position,top100$Mean.Cov,col="blue")
abline(v=-150)
abline(v=50)
dev.off()

bottom<-read.csv("MergedControls_Plasma_Bottom1000_tss.txt",header=TRUE,sep="\t")
top<-read.csv("MergedControls_Plasma_Top1000_tss.txt",header=TRUE,sep="\t")
top100<-read.csv("MergedControls_Plasma_Top100_tss.txt",header=TRUE,sep="\t")
png(filename = paste("Merged_Controls_Top_vs_Bottom_Top100_indicator_figure.png",sep=""), width = 600, height = 600, units = "px", pointsize = 5, bg = "white", res = NA)
plot(bottom$Position,bottom$Mean.Cov,type="l",xlab="Position relative to TSS",ylab="Read depth",col="green",ylim=c(0,1))
polygon(c(bottom$Position,rev(bottom$Position)),c(bottom$LowerBound,rev(bottom$UpperBound)),col=rgb(0.2,0.8,0.3,0.2), border = FALSE)
lines(bottom$Position,bottom$Mean.Cov,col="green",lwd=3)
polygon(c(top$Position,rev(top$Position)),c(top$LowerBound,rev(top$UpperBound)),col=rgb(1,0,0,0.2), border = FALSE)
lines(top$Position,top$Mean.Cov,col="red",lwd=3)
polygon(c(top100$Position,rev(top100$Position)),c(top100$LowerBound,rev(top100$UpperBound)),col=rgb(0,0,1,0.2), border = FALSE)
lines(top100$Position,top100$Mean.Cov,col="blue",lwd=3)
abline(v=-150,lwd=3)
abline(v=50,lwd=3)
dev.off()


bottom<-read.csv("MergedControls_Plasma_Bottom1000_tss.txt",header=TRUE,sep="\t")
top<-read.csv("MergedControls_Plasma_Top1000_tss.txt",header=TRUE,sep="\t")
cnv<-read.csv("CNV_samples_Top1000_tss.txt",header=TRUE,sep="\t")
png(filename = paste("Merged_Controls_Top_vs_Bottom_CNV.png",sep=""), width = 1180, height = 1180, units = "px", pointsize = 20, bg = "white", res = NA)
plot(bottom$Position,bottom$Mean.Cov,type="l",xlab="Position relative to TSS",ylab="Read depth",col="green",ylim=c(0,1.2))
polygon(c(bottom$Position,rev(bottom$Position)),c(bottom$LowerBound,rev(bottom$UpperBound)),col=rgb(0.2,0.8,0.3,0.2), border = FALSE)
lines(bottom$Position,bottom$Mean.Cov,col="green")
polygon(c(top$Position,rev(top$Position)),c(top$LowerBound,rev(top$UpperBound)),col=rgb(1,0,0,0.2), border = FALSE)
lines(top$Position,top$Mean.Cov,col="red")
polygon(c(cnv$Position,rev(cnv$Position)),c(cnv$LowerBound,rev(cnv$UpperBound)),col=rgb(0,0,1,0.2), border = FALSE)
lines(cnv$Position,cnv$Mean.Cov,col="blue")
dev.off()


bottom<-read.csv("MergedControls_Plasma_Bottom1000_tss.txt",header=TRUE,sep="\t")
top<-read.csv("MergedControls_Plasma_Top1000_tss.txt",header=TRUE,sep="\t")
cnv<-read.csv("CNV_samples_Top1000_tss.txt",header=TRUE,sep="\t")
png(filename = paste("Merged_Controls_Top_vs_Bottom_CNV_Figure.png",sep=""), width = 600, height = 600, units = "px", pointsize = 5, bg = "white", res = NA)
plot(bottom$Position,bottom$Mean.Cov,type="l",xlab="Position relative to TSS",ylab="Read depth",col="green",ylim=c(0,1))
polygon(c(bottom$Position,rev(bottom$Position)),c(bottom$LowerBound,rev(bottom$UpperBound)),col=rgb(0.2,0.8,0.3,0.2), border = FALSE)
lines(bottom$Position,bottom$Mean.Cov,col="green",lwd=3)
polygon(c(top$Position,rev(top$Position)),c(top$LowerBound,rev(top$UpperBound)),col=rgb(1,0,0,0.2), border = FALSE)
lines(top$Position,top$Mean.Cov,col="red",lwd=3)
polygon(c(cnv$Position,rev(cnv$Position)),c(cnv$LowerBound,rev(cnv$UpperBound)),col=rgb(0,0,1,0.2), border = FALSE)
lines(cnv$Position,cnv$Mean.Cov,col="blue",lwd=3)
dev.off()



gtex_household<-read.csv("MergedControls_Household_GTEx_tss.txt",header=TRUE,sep="\t")
gtex_brain<-read.csv("MergedControls_Brain_GTEx_tss.txt",header=TRUE,sep="\t")
fantom5_household<-read.csv("MergedControls_Household_FANTOM5_tss.txt",header=TRUE,sep="\t")
png(filename = paste("Household_vs_Brain.png",sep=""), width = 1180, height = 1180, units = "px", pointsize = 20, bg = "white", res = NA)
plot(gtex_brain$Position,gtex_brain$Mean.Cov,type="l",xlab="Position relative to TSS",ylab="Read depth",col="green",ylim=c(0,1.2))
polygon(c(gtex_brain$Position,rev(gtex_brain$Position)),c(gtex_brain$LowerBound,rev(gtex_brain$UpperBound)),col=rgb(0.2,0.8,0.3,0.2), border = FALSE)
lines(gtex_brain$Position,gtex_brain$Mean.Cov,col="green")
polygon(c(gtex_household$Position,rev(gtex_household$Position)),c(gtex_household$LowerBound,rev(gtex_household$UpperBound)),col=rgb(1,0,0,0.2), border = FALSE)
lines(gtex_household$Position,gtex_household$Mean.Cov,col="red")
polygon(c(fantom5_household$Position,rev(fantom5_household$Position)),c(fantom5_household$LowerBound,rev(fantom5_household$UpperBound)),col=rgb(0,0,1,0.2), border = FALSE)
lines(fantom5_household$Position,fantom5_household$Mean.Cov,col="blue")
dev.off()
