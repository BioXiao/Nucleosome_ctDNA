bottom<-read.csv("MergedControls_Plasma_Bottom1000_tss.txt",header=TRUE,sep="\t")
top<-read.csv("MergedControls_Plasma_Top1000_tss.txt",header=TRUE,sep="\t")
png(filename = paste("MergedControls_Top_vs_Bottom_figure.png",sep=""), width = 600, height = 600, units = "px", pointsize = 10, bg = "white", res = 150)
plot(bottom$Position,bottom$Mean.Cov,type="l",xlab="Position relative to TSS",ylab="Read depth",col="green",ylim=c(0,1))
polygon(c(bottom$Position,rev(bottom$Position)),c(bottom$LowerBound,rev(bottom$UpperBound)),col=rgb(0.2,0.8,0.3,0.2), border = FALSE)
lines(bottom$Position,bottom$Mean.Cov,col="green")
polygon(c(top$Position,rev(top$Position)),c(top$LowerBound,rev(top$UpperBound)),col=rgb(1,0,0,0.2), border = FALSE)
lines(top$Position,top$Mean.Cov,col="red")
dev.off()

bottom<-read.csv("MergedControls_Plasma_Bottom1000_tss.txt",header=TRUE,sep="\t")
top<-read.csv("MergedControls_Plasma_Top1000_tss.txt",header=TRUE,sep="\t")
top100<-read.csv("MergedControls_Plasma_Top100_tss.txt",header=TRUE,sep="\t")
png(filename = paste("Merged_Controls_Top_vs_Bottom_Top100_indicator_figure.png",sep=""), width = 600, height = 600, units = "px", pointsize = 5, bg = "white", res = NA)
plot(bottom$Position,bottom$Mean.Cov,type="l",xlab="Position relative to TSS",ylab="Read depth",col="green",ylim=c(0,1))
polygon(c(bottom$Position,rev(bottom$Position)),c(bottom$LowerBound,rev(bottom$UpperBound)),col=rgb(0.2,0.8,0.3,0.2), border = FALSE)
lines(bottom$Position,bottom$Mean.Cov,col="green",lwd=3)
polygon(c(top$Position,rev(top$Position)),c(top$LowerBound,rev(top$UpperBound)),col=rgb(1,0,0,0.2), border = FALSE)
lines(top$Position,top$Mean.Cov,col="red",lwd=3)
polygon(c(top100$Position,rev(top100$Position)),c(top100$LowerBound,rev(top100$UpperBound)),col=rgb(0,0,1,0.2), border = FALSE)
lines(top100$Position,top100$Mean.Cov,col="blue",lwd=3)
abline(v=-150,lwd=3)
abline(v=50,lwd=3)
dev.off()

